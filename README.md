Задача:

*ТЗ не мое. 

2. На основании DWH собрать OLAP куб с максимально возможной детализацией. (Приветствуется использование расчетных показателей на уровне куба, например, средний чек. 
Из обязательных показателей - расчетный остаток на основании всех описанных видов движений.)

Справочники:

Дата
Номенклатура (goods.xml)
Номенклатурные группы (goodgroups.xml)
Производители (manufactures.xml)
Аптеки (stores.xml)
Поставщики (suppliers.xml)

Факты:

Чеки (receipt.xml)  
-- Заголовок чека  
receipt_id     -- Уникальный GUID чека  
terminalid     -- Регистрационный номер фискального регистратора (или уникальный идентификатор рабочего места кассира)  
warehouseid    -- ID склада/магазина в системе VirtualPos  
doc_type       -- Тип чека: sale (продажа) или return (возврат)  
date          -- Дата продажи в формате dd.mm.yyyy hh:mi:ss  
items_count    -- Количество товаров в чеке  

-- Строки чека  
line_id        -- Уникальный GUID строки чека  
itemid         -- ID товара в VirtualPos  
discount_name  -- Наименование акции  
quantity       -- Количество товара в чеке  
pricebase      -- Цена по прайслисту за единицу товара (без учета скидки)  
pricesale      -- Цена продажи за единицу товара (с учетом скидки)  
discount       -- Сумма скидки  
amount         -- Сумма по строке чека (с учетом скидки)  
cogs          -- Себестоимость товара  

Приход (income.xml)  
-- Заголовок прихода  
id            -- ID документа поступления  
warehouse_id  -- Код склада, на который оформлено поступление  
docdate       -- Дата документа поступления  
supplier_id   -- ID поставщика  
amount        -- Сумма поставки  
status        -- Статус документа поставки (accept – принят, draft – черновик)  

-- Строки прихода  
item_id       -- ID товарной позиции по номенклатурному справочнику  
quantity      -- Количество товара  
price         -- Цена поступления  
amount        -- Сумма  

Перемещения (movegood.xml)  
-- Заголовок перемещения  
id              -- Уникальный GUID перемещения  
src_warehouse_id -- Код склада, с которого перемещается товар  
dst_warehouse_id -- Код склада, на который перемещается товар  
amount          -- Сумма перемещения  
status         -- Код статуса документа  
status_name    -- Статус документа  
created_date    -- Дата создания документа перемещения (dd.mm.yyyy hh:mi:ss)  

-- Строки перемещения  
line_id       -- Уникальный GUID строки перемещения  
item_id       -- ID товара в VirtualPos  
quantity      -- Количество товара  
price         -- Себестоимость товара в перемещении  
amount        -- Сумма по строке  

Возврат (returns.xml)  
-- Заголовок возврата  
id            -- Уникальный GUID возврата  
warehouse_id  -- Код склада  
docnum        -- Код документа  
docdate       -- Дата документа возврата поставщику  
supplier_id   -- Код поставщика  
amount        -- Сумма возврата  
status        -- Код статуса документа  
status_name   -- Статус документа  

-- Строки возврата  
line_id       -- Уникальный GUID строки возврата  
item_id       -- ID товара в VirtualPos  
quantity      -- Количество товара  
price         -- Себестоимость товара в перемещении  
amount        -- Сумма по строке  
expir_date    -- Срок годности товара  

Текущий остаток (stock.xml)  
-- Заголовок остатков  
id            -- Код склада  

-- Строки остатков  
id            -- ID товарной позиции по номенклатурному справочнику  
quantity      -- Количество товара  
price         -- Цена поступления  
cogs          -- Себестоимость  
